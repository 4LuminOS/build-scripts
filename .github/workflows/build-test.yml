name: LuminOS Build Test

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - name: Check out repository code
      uses: actions/checkout@v4

    - name: Install dependencies
      run: |
        sudo apt-get update
        sudo apt-get install -y debootstrap debian-archive-keyring plymouth

    - name: Make scripts executable
      run: chmod +x *.sh

    - name: Run LuminOS build scripts
      run: |
        sudo ./01-build-base-system.sh
        sudo ./02-configure-system.sh
        sudo ./03-install-desktop.sh
        sudo ./04-customize-desktop.sh
        sudo ./05-install-ai.sh
        sudo ./07-install-plymouth-theme.sh # Ajouté ici
        sudo ./06-final-cleanup.sh         # Déplacé à la fin
      env:
        CI: true

    - name: Verify build output
      run: |
        echo "Build finished! Listing contents of the chroot directory:"
        ls -lA chroot/
